function initMember(){require(["member"],function(e){e.showMembers("default",1)})}function index_search(){require(["member"],function(e){e.showMembers("search",1)})}function index_allsearch(){require(["member"],function(e){e.showMembers("allsearch",1)})}function initAddMember(){require(["member"],function(e){e.editMemberInfo()})}function addmember_sendvcode(){require(["member"],function(e){e.sendSignCode()})}function addmember_Commit(){require(["member"],function(e){e.EditMember()})}function addmember_checkuser(){require(["member"],function(e){var t=$("#member_mobile").val();e.checkUser(t)})}function selectTable(e){var t=e.innerHTML;t=t.replace(/<.+?>/g,"");var a=$("#member_tag").val(),s=t.indexOf("（");s>0&&(t=t.substr(0,s)),console.log(t);var r=a.indexOf(t);r>=0||(a.length>0?$("#member_tag").val(a+","+t):$("#member_tag").val(t))}function select_pages(e,t){require(["member"],function(t){var a=$("#page_size").val();t.setPageSize(a),t.showMembers(e,1)})}define("core",[],function(){function submitPwd(e){$.ajax({type:"POST",data:e,url:getHost()+"/member/updatePwd",success:function(e){var t=JSON.parse(e);console.log(t),t.status?(layer.msg("密码修改成功！"),$("#pwd-modal").modal("hide")):layer.msg("密码修改失败！")}})}var doTinit=function(){doT.templateSettings={evaluate:/\[\%([\s\S]+?)\%\]/g,interpolate:/\[\%=([\s\S]+?)\%\]/g,encode:/\[\%!([\s\S]+?)\%\]/g,use:/\[\%#([\s\S]+?)\%\]/g,define:/\[\%##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\%\]/g,conditional:/\[\%\?(\?)?\s*([\s\S]*?)\s*\%\]/g,iterate:/\[\%~\s*(?:\%\]|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\%\])/g,varname:"it",strip:!0,append:!0,selfcontained:!1}},getHost=function(){var e=location.origin||location.protocol+"//"+location.hostname+(80==location.port?"":":"+location.port);return e},exeError=function(e,t,a,s){if("http"==e.type){var r="status:"+t.status+" state:"+t.readyState+" text:"+a+" err:"+JSON.stringify(s);e.desc=r}console.log("错误处理："+JSON.stringify(e))},formatDate=function(){Date.prototype.format=function(e){e||(e="yyyy-MM-dd hh:mm:ss");var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e}},ReConsole=function(){window.console=window.console||function(){var e={};return e.log=e.warn=e.debug=e.info=e.error=e.time=e.dir=e.profile=e.clear=e.exception=e.trace=e.assert=function(){},e}()},isExitsFunction=function(funcName){try{if("function"==typeof eval(funcName))return!0}catch(e){}return!1},isExitsVariable=function(e){try{return"undefined"!=typeof e}catch(t){}return!1};return $(document).on("click","#branner .download",function(){try{localStorage.setItem("is_show",!0)}catch(e){}}),$(document).on("click","#upgrade-bar .sui-close",function(){try{localStorage.setItem("upgrade-version",CURRENT_VERSION)}catch(e){}}),$(document).on("shown","#pwd-modal",function(){$("#pwd-form").validate({success:function(e){var t=e.serializeArray();submitPwd(t)}})}),$(document).on("hidden","#pwd-modal",function(){$("#pwd-form")[0].reset()}),$(function(){$.ajax({type:"get",url:getHost()+"/helpful/upgrade",dataType:"json"}).done(function(e){return e.status&&e.result.items.length?($("#upgrade-bar").find(".upgrade-title").empty().append(e.result.items[0].title).end().show(),$("#upgrade").find(".upgrade-content").empty().append(e.result.items[0].content),void(200==e.result.items[0].tips_type&&$("#upgrade-bar").hide())):null})}),$(function(){$.ajax({type:"POST",url:getHost()+"/store/getGrcode",success:function(e){1!=e&&$("#grcode").attr("src",e)},error:function(e,t){console.log("status:"+e.status),console.log("state:"+e.readyState),console.log("text:"+t)}})}),{doTinit:doTinit,getHost:getHost,exeError:exeError,formatDate:formatDate,ReConsole:ReConsole,isExitsVariable:isExitsVariable,isExitsFunction:isExitsFunction}}),define("tools",[],function(){var e=function(e,s,r){var n,l=!1;switch(e){case"member":n=new RegExp("^[0-9]*$"),n.test(s)&&(l=!0);break;case"mobile":n=/^(((13[0-9]{1})|(14[0-9]{1})|(15[0-9]{1})|(17[0-9]{1})|(18[0-9]{1}))+\d{8})$/,n.test(s)&&(l=!0);break;case"gt":parseInt(s)>parseInt(r)&&(l=!0);break;case"lt":parseInt(s)<parseInt(r)&&(l=!0);break;case"max":a(s)<=parseFloat(r)&&(l=!0);break;case"min":a(s)>=parseFloat(r)&&(l=!0);break;case"cmax":0!=s.length&&(n=/^[\u4E00-\u9FA5]+$/,n.test(s)&&a(s)<=parseFloat(r)&&(l=!0));break;case"cmin":0!=s.length&&(n=/^[\u4E00-\u9FA5]+$/,n.test(s)&&a(s)>=parseFloat(r)&&(l=!0));break;case"idcard":var i=t(s);i&&(l=!0);break;case"email":0!=s.length&&(n=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,n.test(s)&&(l=!0));break;case"qq":n=/^\d{5,15}$/,n.test(s)&&(l=!0)}return l},t=function(e){if(e=e.toUpperCase(),!/(^\d{15}$)|(^\d{17}([0-9]|X)$)/.test(e))return!1;var t,a;if(t=e.length,15==t){a=new RegExp(/^(\d{6})(\d{2})(\d{2})(\d{2})(\d{3})$/);var s,r=e.match(a),n=new Date("19"+r[2]+"/"+r[3]+"/"+r[4]);if(s=n.getYear()==Number(r[2])&&n.getMonth()+1==Number(r[3])&&n.getDate()==Number(r[4])){var l,i=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2),o=new Array("1","0","X","9","8","7","6","5","4","3","2"),c=0;for(e=e.substr(0,6)+"19"+e.substr(6,e.length-6),l=0;17>l;l++)c+=e.substr(l,1)*i[l];return e+=o[c%11],!0}return!1}if(18==t){a=new RegExp(/^(\d{6})(\d{4})(\d{2})(\d{2})(\d{3})([0-9]|X)$/);var s,r=e.match(a),n=new Date(r[2]+"/"+r[3]+"/"+r[4]);return s=n.getFullYear()==Number(r[2])&&n.getMonth()+1==Number(r[3])&&n.getDate()==Number(r[4]),!!s}return!1},a=function(e){for(var t=0,a=0;a<e.length;a++){var s=e.charAt(a);t+=encodeURI(s).length>2?1:.5}return console.log(e+" length:"+t),t},s=function(e,t,a){var s=new Date;s.setDate(s.getDate()+a),document.cookie=e+"="+escape(t)+(null==a?"":";expires="+s.toGMTString())},r=function(e){return document.cookie.length>0&&(c_start=document.cookie.indexOf(e+"="),-1!=c_start)?(c_start=c_start+e.length+1,c_end=document.cookie.indexOf(";",c_start),-1==c_end&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):""};return{validate:e,getStringLength:a,setCookie:s,getCookie:r}}),define("service/pagin",[],function(){return $.fn.pagination.Constructor.prototype=$.extend($.fn.pagination.Constructor.prototype,{_drawCtrl:function(){var e="";if(this.pageSize&&this.itemsCount){var t=$('<select class="page-size-sel"></select>'),a=[15,30,50,100];for(var s in a){var r='<option value="'+a[s]+'"'+(this.pageSize==a[s]?"selected":"")+">"+a[s]+"</option>";t.append(r)}e+=t.prop("outerHTML"),e+="<div>&nbsp;"+("itemsCount"==this.displayInfoType?"<span>共"+this.itemsCount+"条</span>&nbsp;":"<span>共"+this.pages+"页</span>&nbsp;")+"("+this.itemsCount+'条记录)<span>&nbsp;到&nbsp;<input type="text" class="page-num"/><button class="page-confirm">确定</button>&nbsp;页</span></div>'}else e="<div>&nbsp;"+("itemsCount"==this.displayInfoType?"<span>共"+this.itemsCount+"条</span>&nbsp;":"<span>共"+this.pages+"页</span>&nbsp;")+'<span>&nbsp;到&nbsp;<input type="text" class="page-num"/><button class="page-confirm">确定</button>&nbsp;页</span></div>';return e},updateConfig:function(e){e.pageSize&&(this.pageSize=e.pageSize)}}),function(e,t,a,s,r,n,l){if(t=t||1,a=a||1,a||(a=Math.ceil(r/s)),"object"!=typeof e)var i=$(e);else i=e;i.data("sui-pagination",""),i.pagination({pages:a,styleClass:["pagination-large","pagination-right"],showCtrl:!0,displayPage:6,pageSize:s,itemsCount:r,currentPage:t,onSelect:n}),i.pagination("updatePages",~~a,~~t),i.data("evt-init")||(i.on("change",".page-size-sel",function(){i.pagination("updateConfig",{pageSize:+this.value}),n(1)}),i.data("evt-init",1))}}),define("member",["core","tools","service/pagin"],function(e,t,a){var s=15,r=function(e){s=e},n=function(s,r){var l={},i=$(".page-size-sel").val()||15;if(l.pageSize=i,l.pageno=r,"search"!=s&&"allsearch"!=s||(l.start=$("#date_start").val(),l.end=$("#date_end").val(),l.mobile=$("#mobile").val(),l.invite_code=$("#invite_code").val()),"allsearch"==s){if(l.type="all",!t.validate("mobile",l.mobile,null))return $.alert({title:"温馨提示!",backdrop:"static",body:"请输入正确的手机号！"}),!1}else l.type="self";var o=layer.load(1,{shade:[.1,"#fff"]}),c=new Date;$.ajax({type:"POST",data:l,url:e.getHost()+"/member/getMembers",success:function(e){new Date-c<1500?setTimeout(function(){layer.close(o)},1500-(new Date-c)):layer.close(o);var t=JSON.parse(e);if(t.status){var r=$("#list_template").html(),l=doT.template(r),m=l(t);$("#member_list").html(m),a("#pagelsit",+t.result.current,t.result.total_pages,i,t.result.total_items,function(e){n(s,e)}),$("#pagelsit").show()}else $("#member_list").html('<tr><td colspan="8"  style="text-align: center;">'+t.result.msg+"</td></tr>"),$("#pagelsit").hide()}}),console.log("展示")},l=function(){var t=$("#member_id").val();if(""!=t){var a={id:t};$.ajax({type:"POST",data:a,url:e.getHost()+"/member/getMember",success:function(e){var t=JSON.parse(e);t.status?($("#member_mobile").val(t.result.mobile).attr("readonly","readonly"),$("#member_name").val(t.result.name),t.result.invite_code&&t.result.invite_clerk_name?($("#invite_code_only").html(t.result.invite_code).css("color","red").show(),$("#invite_code_name").html("("+t.result.invite_clerk_name+")").show()):t.result.invite_code&&$("#invite_code_only").html(t.result.invite_code+"()").show(),$("input[name=member_sex]").attr("checked",!1),$("input[name=member_sex][value="+t.result.sex+"]").attr("checked",!0),$("#sex_"+t.result.sex).attr("class","radio-pretty inline checked"),$("#member_email").val(t.result.email),$("#member_qq").val(t.result.qq),$("#member_vcard").val(t.result.membership_number),$("#member_vcardt").val(t.result.barcode),$("#member_tag").val(t.result.tag),$("#member_mark").val(t.result.memo),$("#member_idcard").val(t.result.idcard_number),$("#member_age").val(t.result.age),parseInt(t.result.birthday)&&$("#birthday").val(t.result.birthday),$("#surplus-integrate").show().html("剩余积分："+t.result.integrate),$("#div_member_code").hide(),$("#hsbtn").css("display","none"),i(t.result.address)):$.alert({title:"温馨提示!",body:t.result.msg})}})}else $("#sex_2").attr("class","radio-pretty inline checked"),$("input[name=member_sex][value=2]").attr("checked",!0)},i=function(t){var a={};if(t.length>0){var s=t.split(" "),r="";if(s.length>=4){a.province=s[0],a.city=s[1],a.country=s[2];for(var n=3;n<s.length;n++)r+=s[n]+" "}else if(s.length>=3){a.province=s[0],a.city=s[1];for(var n=2;n<s.length;n++)r+=s[n]+" "}$("#member_address").val(r),$.ajax({type:"POST",data:a,async:!0,url:e.getHost()+"/lib/getAreaCode",success:function(e){var t=JSON.parse(e);t.status&&$("#store_citys").tree("setValue",[t.result.province,t.result.city,t.result.country])}})}},o=function(){var t={};t.memberid=$("#member_id").val(),t.mobile=$("#member_mobile").val(),t.code=$("#member_code").val(),t.name=$("#member_name").val(),t.invite_code=$("#invite_code").val(),t.sex=$('input[name="member_sex"]:checked').val(),t.email=$("#member_email").val(),t.qq=$("#member_qq").val(),t.citys=$("#store_citys").data("tree").datas,t.address=$("#member_address").val(),t.vcard=$("#member_vcard").val(),t.vcardt=$("#member_vcardt").val(),t.tag=$("#member_tag").val(),t.mark=$("#member_mark").val(),t.idcard=$("#member_idcard").val(),t.age=$("#member_age").val(),t.birthday=$("#birthday").val(),t.invite_code=$("#invite_code").val(),$("#integrate").size()&&(t.integrate=$("#integrate").val()),t.tag=t.tag.replace(/，/g,",");var a=c(t);a.flag?$.ajax({type:"POST",data:t,url:e.getHost()+"/member/edit",success:function(t){console.log("edit Members :"+t);var a=JSON.parse(t);a.status?window.location.href=e.getHost()+"/member/index":$.alert({title:"温馨提示!",body:a.result.msg})}}):$.alert({title:"温馨提示!",backdrop:"static",body:a.msg})},c=function(e){var a={flag:!0,msg:""};return t.validate("mobile",e.mobile,null)?""!=e.memberid||t.validate("min",e.code,1)?t.validate("min",e.name.replace(/(^\s*)|(\s*$)/g,""),.5)&&t.validate("max",e.name,10)||(a.flag=!1,a.msg="姓名不能为空且不超过10个字！"):(a.flag=!1,a.msg="请填写验证码！"):(a.flag=!1,a.msg="请填写正确的手机号！"),e.idcard.replace(/(^\s*)|(\s*$)/g,"").length>0&&!t.validate("idcard",e.idcard,null)&&(a.flag=!1,a.msg="身份证号码格式不正确！"),e.email.replace(/(^\s*)|(\s*$)/g,"").length>0&&!t.validate("email",e.email,null)?(a.flag=!1,a.msg="邮箱格式不正确！"):e.email.replace(/(^\s*)|(\s*$)/g,"").length>0&&!t.validate("max",e.email,20)&&(a.flag=!1,a.msg="邮箱不能超过40个英文字符！"),e.qq.replace(/(^\s*)|(\s*$)/g,"").length>0&&!t.validate("qq",e.qq,null)&&(a.flag=!1,a.msg="QQ 号格式不正确或超过了15位！"),e.address.replace(/(^\s*)|(\s*$)/g,"").length>0&&(3==e.citys.text.length&&""==e.citys.value[2]||e.citys.text.length<3&&(e.citys.text.length<2||2==e.citys.text.length&&""==e.citys.value[1])?(a.flag=!1,a.msg="请选择省份！"):e.address=e.citys.text[0]+" "+e.citys.text[1]+" "+(e.citys.text[2]?e.citys.text[2]+" ":"")+e.address,t.validate("max",e.address,80)||(a.flag=!1,a.msg="地址不能超过80个字！")),e.vcard.replace(/(^\s*)|(\s*$)/g,"").length>0&&!t.validate("max",e.vcard,30)&&(a.flag=!1,a.msg="卡号不能超过30个字！"),e.vcardt.replace(/(^\s*)|(\s*$)/g,"").length>0&&!t.validate("max",e.vcardt,30)&&(a.flag=!1,a.msg="条形码不能超过30个字！"),e.tag.replace(/(^\s*)|(\s*$)/g,"").length>0&&!t.validate("max",e.tag,100)&&(a.flag=!1,a.msg="标签不能超过100个字！"),e.mark.replace(/(^\s*)|(\s*$)/g,"").length>0&&!t.validate("max",e.mark,200)&&(a.flag=!1,a.msg="备注不能超过200个字！"),a},m=function(){var a={};a.mobile=$("#member_mobile").val(),t.validate("mobile",a.mobile,null)?$.ajax({type:"POST",data:a,url:e.getHost()+"/member/sendCode",success:function(e){console.log("edit Members :"+e);var t=JSON.parse(e);t.status?($.alert({title:"温馨提示!",body:t.result.msg}),d(a.mobile)):$.alert({title:"温馨提示!",body:t.result.msg})}}):$.alert({title:"温馨提示!",body:"请填写正确的手机号！"})},d=function(e){var a=60,s={hsTime:function(s){console.log("wait:"+a);var r=t.getCookie("wait"+e);if(""!=r&&(a=parseInt(r)),0==a)$(s).attr("onclick","addmember_sendvcode();").html("重发短信验证码"),t.setCookie("wait"+e,a,0);else{$(s).removeAttr("onclick").html("在"+a+"秒后点此重发"),a--;var n=this;t.setCookie("wait"+e,a,1),setTimeout(function(){n.hsTime(s)},1e3)}}};s.hsTime("#hsbtn")},u=function(t){var a={};a.mobile=t,$.ajax({type:"POST",data:a,async:!1,url:e.getHost()+"/member/getCheckUser",success:function(e){console.log("用户验证:"+e);var t=JSON.parse(e);t.status&&(t.result.check?($("#check_user").attr("style","display: inline;"),$("#add_sure").removeAttr("onclick")):($("#check_user").attr("style","display: none;"),$("#add_sure").attr("onclick","addmember_Commit();"),m()))}})};return{showMembers:n,EditMember:o,sendSignCode:m,editMemberInfo:l,checkUser:u,setPageSize:r}}),define("clerk",["core","tools","service/pagin"],function(e,t,a){function s(){var t={};$("#store_name").val(),$("#store_id").val();t.per_page=1e6,t.stores_status=1,$.ajax({type:"POST",data:t,url:e.getHost()+"/store/getList",success:function(e){var t=JSON.parse(e);if(t.status){for(var a=[],s=0,r=t.result.items.length;r>s;s++){var n={};n.value=t.result.items[s].name,n.data=t.result.items[s].id,a[s]=n}$("#autocomplete").autocomplete({lookup:a,minChars:0,onSelect:function(e){$("#assistant_new_store").val(e.data)}})}}})}var r=15,n=function(e){r=e},l=function(t,s){var r={},n=$(".page-size-sel").val()||15;r.pagesize=n,r.pageno=s,"search"==t&&(r.start=$("#date_start").val(),r.end=$("#date_end").val(),r.mobile=$("#phone").val(),r.clerk_name=$("#clerk_name").val(),r.invite_code=$("#invite_code_input").val());var i=layer.load(1,{shade:[.1,"#fff"]}),o=new Date;$.ajax({type:"POST",data:r,url:e.getHost()+"/clerk/getClerks",success:function(e){new Date-o<1500?setTimeout(function(){layer.close(i)},1500-(new Date-o)):layer.close(i);var s=JSON.parse(e);if(1==s.status){var r=$("#list_template").html(),c=doT.template(r),m=c(s);$("#clerk_list").html(m),a("#pagelsit",+s.result.current,s.result.total_pages,n,s.result.total_items,function(e){l(t,e)})}else $("#clerk_list").html('<tr><td colspan="8"  style="text-align: center;">'+s.result.msg+"</td></tr>"),$("#pagelsit").html("")}}),console.log("展示")},i=function(){var e=$("#clerksex").val();$.isNumeric(e)&&$("input[name=sex][value="+e+"]").attr("checked",!0)},o=function(){var t={};t.mobile=$("#mobile").val(),t.password=$("#password").val(),t.name=$("#name").val(),t.name=t.name.replace(/(\s*)/g,""),t.sex=$('input[name="sex"]:checked').val(),t.idcard_number=$("#idcard").val(),t.birthday=$("#birthday").val(),t.email=$("#email").val(),t.qq=$("#qq").val(),t.clerk_job=$("#work").val(),t.memo=$("#mark").val(),t.employee_number=$("#employee_number").val(),t.status=$("[name=status]:checked").val(),t.group_ids=$('[name="group-ids[]"]:checked').map(function(){return this.value}).get().join(","),t.role_ids=$('[name="role-ids[]"]:checked').map(function(){return this.value}).get().join(",");var a=d(t);a.flag?$.ajax({type:"POST",data:t,async:!1,url:e.getHost()+"/clerk/addclerks",success:function(t){console.log("添加店员:"+t);var a=JSON.parse(t);1==a.status?layer.msg("添加店员成功！",function(){window.location.href=e.getHost()+"/clerk/index"}):$.alert({title:"温馨提示!",body:a.result.msg})}}):$.alert({title:"温馨提示!",body:a.msg})},c=function(){var t={};t.id=$("#clerkid").val(),t.mobile=$("#mobile").val(),t.password=$("#password").val(),t.name=$("#name").val(),t.name=t.name.replace(/(\s*)/g,""),t.sex=$('input[name="sex"]:checked').val(),t.idcard_number=$("#idcard").val(),t.birthday=$("#birthday").val(),t.email=$("#email").val(),t.qq=$("#qq").val(),t.clerk_job=$("#work").val(),t.memo=$("#mark").val(),t.employee_number=$("#employee_number").val(),t.status=$("[name=status]:checked").val(),t.group_ids=$('[name="group-ids[]"]:checked').map(function(){return this.value}).get().join(","),t.role_ids=$('[name="role-ids[]"]:checked').map(function(){return this.value}).get().join(",");var a=d(t);a.flag?$.ajax({type:"POST",data:t,async:!1,url:e.getHost()+"/clerk/editclerks",success:function(t){console.log("修改店员:"+t);var a=JSON.parse(t);1==a.status?layer.msg("修改店员成功！",function(){window.location.href=e.getHost()+"/clerk/index"}):$.alert({title:"温馨提示!",body:a.result.msg})}}):$.alert({title:"温馨提示!",body:a.msg})},m=function(t){var a={};a.id=t,$.ajax({type:"POST",data:a,async:!1,url:e.getHost()+"/clerk/deleteClerks",success:function(t){console.log("删除店员:"+t);var a=JSON.parse(t);a.status?$.alert({title:"温馨提示!",body:"店员删除成功",okHide:function(){window.location.href=e.getHost()+"/clerk/index"}}):$.alert({title:"温馨提示!",body:a.result.msg})}})},d=function(e){var a={flag:!0,msg:""};return t.validate("mobile",e.mobile,null)?t.validate("min",e.name.replace(/(^\s*)|(\s*$)/g,""),.5)&&t.validate("max",e.name,10)||(a.flag=!1,a.msg="姓名不能为空且不超过10个字！"):(a.flag=!1,a.msg="请填写正确的手机号！"),e.idcard_number.replace(/(^\s*)|(\s*$)/g,"").length>0&&!t.validate("idcard",e.idcard_number,null)&&(a.flag=!1,a.msg="身份证号码格式不正确！"),e.email.length>0&&!t.validate("email",e.email,null)&&(a.flag=!1,a.msg="邮箱格式不正确！"),e.email.length>0&&!t.validate("max",e.email,20)&&(a.flag=!1,a.msg="邮箱格式不正确！"),e.qq.length>0&&!t.validate("qq",e.qq,null)&&(a.flag=!1,a.msg="QQ 号格式不正确！"),e.clerk_job.length>0&&!t.validate("cmax",e.clerk_job,10)&&(a.flag=!1,a.msg="店员职业必须为汉字且不超过10个字！"),e.memo.length>0&&!t.validate("max",e.memo,200)&&(a.flag=!1,a.msg="备注不能超过200个字！"),a},u=function(){var t={};t.assistant_mobile=$("#assistant_mobile").val(),t.assistant_new_store=$("#assistant_new_store").val(),t.store_name=$("#autocomplete").val(),t.authcode=$("#auth_code").val(),t.clerk_id=$("#admin_id").val(),$.ajax({type:"POST",data:t,async:!0,url:e.getHost()+"/clerk/ChangeStore",success:function(t){console.log("门店调配:"+t);var a=JSON.parse(t);a.status?$.alert({title:"温馨提示!",body:"门店修改成功",okHide:function(){window.location.href=e.getHost()+"/clerk/index"}}):$.alert({title:"温馨提示!",body:a.result.msg})}})},g=function(t,s){var r=$("#pagelsits").find(".page-size-sel").val()||15,n={};n.pagesize=r,n.pageno=t,"search"==s&&(n.clerk_name=$("#clerk_name").val(),n.clerk_mobile=$("#clerk_mobile").val()),$.ajax({type:"POST",data:n,url:e.getHost()+"/clerk/getAllocateHistory",success:function(e){var t=JSON.parse(e);if(1==t.status){var n=$("#allocate_history").html(),l=doT.template(n),i=l(t);$("#allocate_list").html(i),a("#pagelsits",+t.result.current,t.result.total_pages,r,t.result.total_items,function(e){g(e,s)})}else $("#allocate_list").html('<tr><td colspan="8"  style="text-align: center;">'+t.result.msg+"</td></tr>"),$("#pagelsits").html("")}})};return{showClerks:l,addClerks:o,editClerks:c,deleteClerks:m,setinfo:i,setPageSize:n,showChangeStore:u,showstorelist:s,showAllocateHistory:g}}),require.config({paths:{core:"../lovejs/core",tools:"../lovejs/tools",member:"service/member",clerk:"service/clerk"}}),$(function(){require(["core"],function(e){e.doTinit(),e.ReConsole()});var e=window.location.pathname;switch(e){case"/member/index":initMember();break;case"/member/addmember":initAddMember()}}),$(document).on("click",".clerk_selected,.invite_btn",function(){$("#clerkList-modal").modal("show"),require(["clerk"],function(e){e.showClerks("search",1)})}),$(document).on("click",".clerk_select_ok",function(){var e=$(this).siblings().val();$("#clerkList-modal").modal("hide"),$("#invite_code").val(e)}),define("member_index",function(){});