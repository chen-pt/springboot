function initReceipt(){require(["print"],function(t){t.getPrintXiaopiao()})}define("core",[],function(){function submitPwd(t){$.ajax({type:"POST",data:t,url:getHost()+"/member/updatePwd",success:function(t){var e=JSON.parse(t);console.log(e),e.status?(layer.msg("密码修改成功！"),$("#pwd-modal").modal("hide")):layer.msg("密码修改失败！")}})}var doTinit=function(){doT.templateSettings={evaluate:/\[\%([\s\S]+?)\%\]/g,interpolate:/\[\%=([\s\S]+?)\%\]/g,encode:/\[\%!([\s\S]+?)\%\]/g,use:/\[\%#([\s\S]+?)\%\]/g,define:/\[\%##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\%\]/g,conditional:/\[\%\?(\?)?\s*([\s\S]*?)\s*\%\]/g,iterate:/\[\%~\s*(?:\%\]|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\%\])/g,varname:"it",strip:!0,append:!0,selfcontained:!1}},getHost=function(){var t=location.origin||location.protocol+"//"+location.hostname+(80==location.port?"":":"+location.port);return t},exeError=function(t,e,n,o){if("http"==t.type){var i="status:"+e.status+" state:"+e.readyState+" text:"+n+" err:"+JSON.stringify(o);t.desc=i}console.log("错误处理："+JSON.stringify(t))},formatDate=function(){Date.prototype.format=function(t){t||(t="yyyy-MM-dd hh:mm:ss");var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in e)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[n]:("00"+e[n]).substr((""+e[n]).length)));return t}},ReConsole=function(){window.console=window.console||function(){var t={};return t.log=t.warn=t.debug=t.info=t.error=t.time=t.dir=t.profile=t.clear=t.exception=t.trace=t.assert=function(){},t}()},isExitsFunction=function(funcName){try{if("function"==typeof eval(funcName))return!0}catch(e){}return!1},isExitsVariable=function(t){try{return"undefined"!=typeof t}catch(e){}return!1};return $(document).on("click","#branner .download",function(){try{localStorage.setItem("is_show",!0)}catch(t){}}),$(document).on("click","#upgrade-bar .sui-close",function(){try{localStorage.setItem("upgrade-version",CURRENT_VERSION)}catch(t){}}),$(document).on("shown","#pwd-modal",function(){$("#pwd-form").validate({success:function(t){var e=t.serializeArray();submitPwd(e)}})}),$(document).on("hidden","#pwd-modal",function(){$("#pwd-form")[0].reset()}),$(function(){$.ajax({type:"get",url:getHost()+"/helpful/upgrade",dataType:"json"}).done(function(t){return t.status&&t.result.items.length?($("#upgrade-bar").find(".upgrade-title").empty().append(t.result.items[0].title).end().show(),$("#upgrade").find(".upgrade-content").empty().append(t.result.items[0].content),void(200==t.result.items[0].tips_type&&$("#upgrade-bar").hide())):null})}),$(function(){$.ajax({type:"POST",url:getHost()+"/store/getGrcode",success:function(t){1!=t&&$("#grcode").attr("src",t)},error:function(t,e){console.log("status:"+t.status),console.log("state:"+t.readyState),console.log("text:"+e)}})}),{doTinit:doTinit,getHost:getHost,exeError:exeError,formatDate:formatDate,ReConsole:ReConsole,isExitsVariable:isExitsVariable,isExitsFunction:isExitsFunction}}),define("print",["core"],function(t){var e={};return e.getPrintXiaopiao=function(){var n=$("#trades_Id_xiaopiao").val(),o={};o.trades_id=n,$.ajax({type:"POST",data:o,async:!0,url:t.getHost()+"/print/getOrderPrint",success:function(t){$("#shangpin").empty();var n=JSON.parse(t);if(n.status){String.prototype.toFixed=function(t){var t=t||2,e=this.valueOf();return parseFloat(e).toFixed(t)};var o=$("#shangpin_templete").html(),i=doT.template(o),r=i(n);$("#shangpin").html(r),$(".danhao").html(n.result.trades_information.trades_id),$(".shijian").html(n.result.trades_information.pay_time),$(".yingshou").html((n.result.trades_information.total_fee/100).toFixed(2)),$(".cash_payment_pay").html((n.result.trades_information.medical_insurance_card_pay/100).toFixed(2)),$(".youhui").html((n.result.trades_information.line_breaks_pay/100).toFixed(2)),$(".zhaolin").html(parseFloat($(".back").val()).toFixed(2)),$(".cash_pay").html($(".cash").val().toFixed(2)),e.getPrintMendian()}},error:function(t,e,n){console.log(n)}})},e.getPrintMendian=function(){var e={};$.ajax({type:"POST",data:e,async:!0,url:t.getHost()+"/print/getStoreInfo",success:function(t){var e=JSON.parse(t);if(e.status){$(".mendian").html(e.result.name),$(".dianhua").html(e.result.tel);var n=e.result;$(".dizhi").html(n.province+n.city+n.country+n.address)}},error:function(t,e,n){console.log(n)}})},e}),require.config({paths:{core:"../lovejs/core",tools:"../lovejs/tools",print:"service/print"}}),$(function(){require(["core"],function(t){t.doTinit(),t.ReConsole()});var t=window.location.pathname;switch(t){case"/print/receipt":initReceipt()}}),define("print_index",function(){});