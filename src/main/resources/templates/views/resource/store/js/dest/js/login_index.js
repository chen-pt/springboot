function submitfun(){return require(["core"],function(t){function e(){var e={};e.name=$("#name").val(),e.per_page=1e4,e.stores_status=1,$.ajax({type:"POST",data:e,url:t.getHost()+"/store/getList",success:function(t){var e=JSON.parse(t);if(e.status){$("#storelist").empty();for(var n=0,o=e.result.items.length;o>n;n++)$("#storelist").append('<tr><td><input type="hidden" name="store_id" value="'+e.result.items[n].id+'"/><input type="hidden" name="store_name" value="'+e.result.items[n].name+'"/><input type="hidden" name="stores_number" value="'+e.result.items[n].stores_number+'"/>'+e.result.items[n].name+"</td><td>"+e.result.items[n].stores_number+'</td><td><a href="##" class="sui-btn btn-primary btn-sauthcode">确定</a> </td> </tr>')}}})}t.ReConsole(),console.log("login....");var n={};if(n.name=$("#loginName").val(),n.pwd=$("#loginPwd").val(),n.vcode=$("#vcode").val(),n.remember=$("#rememberName").val(),$("#rememberName").is(":checked")?n.remember=1:n.remember=0,/^\/\/\//.test(n.pwd))$.ajax({type:"POST",data:{auth_code:n.pwd},url:t.getHost()+"/login/authcode",dataType:"json",success:function(t){t.status?($(".login-bg").find('input[name="end_time"]').val(t.result.end_time),$("#storelist-modal").modal("show"),e()):$.alert({title:"温馨提示!",body:"用户名或密码错误"})}});else{var o="/login/into";"/login/logininto"==window.location.pathname&&(o="/login/logininto"),$.ajax({type:"POST",data:n,url:t.getHost()+o,success:function(e){console.log("login :"+e);var n=JSON.parse(e);1==n.status?window.location.href=t.getHost()+"/order/index":($("#imgcode_img").click(),$("#error").html(n.result.msg),$("#myModal").modal("show"))},error:function(e,n,o){var s={action:"用户登录",type:"http",desc:""};t.exeError(s,e,n,o)}})}$(function(){$("#storelist-form").validate({success:function(){e()}})}),$(document).on("click",".btn-sauthcode",function(){var e={};e.store_id=$(this).parents("tr").find('input[name="store_id"]').val(),e.store_name=$(this).parents("tr").find('input[name="store_name"]').val(),e.stores_number=$(this).parents("tr").find('input[name="stores_number"]').val(),e.end_time=$(this).parents("#storelist-form").find('input[name="end_time"]').val(),$.ajax({type:"POST",data:e,url:t.getHost()+"/login/iss",success:function(e){var n=JSON.parse(e);n.status&&(window.location.href=t.getHost()+"/order/index")}})})}),!1}define("core",[],function(){function submitPwd(t){$.ajax({type:"POST",data:t,url:getHost()+"/member/updatePwd",success:function(t){var e=JSON.parse(t);console.log(e),e.status?(layer.msg("密码修改成功！"),$("#pwd-modal").modal("hide")):layer.msg("密码修改失败！")}})}var doTinit=function(){doT.templateSettings={evaluate:/\[\%([\s\S]+?)\%\]/g,interpolate:/\[\%=([\s\S]+?)\%\]/g,encode:/\[\%!([\s\S]+?)\%\]/g,use:/\[\%#([\s\S]+?)\%\]/g,define:/\[\%##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\%\]/g,conditional:/\[\%\?(\?)?\s*([\s\S]*?)\s*\%\]/g,iterate:/\[\%~\s*(?:\%\]|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\%\])/g,varname:"it",strip:!0,append:!0,selfcontained:!1}},getHost=function(){var t=location.origin||location.protocol+"//"+location.hostname+(80==location.port?"":":"+location.port);return t},exeError=function(t,e,n,o){if("http"==t.type){var s="status:"+e.status+" state:"+e.readyState+" text:"+n+" err:"+JSON.stringify(o);t.desc=s}console.log("错误处理："+JSON.stringify(t))},formatDate=function(){Date.prototype.format=function(t){t||(t="yyyy-MM-dd hh:mm:ss");var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in e)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[n]:("00"+e[n]).substr((""+e[n]).length)));return t}},ReConsole=function(){window.console=window.console||function(){var t={};return t.log=t.warn=t.debug=t.info=t.error=t.time=t.dir=t.profile=t.clear=t.exception=t.trace=t.assert=function(){},t}()},isExitsFunction=function(funcName){try{if("function"==typeof eval(funcName))return!0}catch(e){}return!1},isExitsVariable=function(t){try{return"undefined"!=typeof t}catch(e){}return!1};return $(document).on("click","#branner .download",function(){try{localStorage.setItem("is_show",!0)}catch(t){}}),$(document).on("click","#upgrade-bar .sui-close",function(){try{localStorage.setItem("upgrade-version",CURRENT_VERSION)}catch(t){}}),$(document).on("shown","#pwd-modal",function(){$("#pwd-form").validate({success:function(t){var e=t.serializeArray();submitPwd(e)}})}),$(document).on("hidden","#pwd-modal",function(){$("#pwd-form")[0].reset()}),$(function(){$.ajax({type:"get",url:getHost()+"/helpful/upgrade",dataType:"json"}).done(function(t){return t.status&&t.result.items.length?($("#upgrade-bar").find(".upgrade-title").empty().append(t.result.items[0].title).end().show(),$("#upgrade").find(".upgrade-content").empty().append(t.result.items[0].content),void(200==t.result.items[0].tips_type&&$("#upgrade-bar").hide())):null})}),$(function(){$.ajax({type:"POST",url:getHost()+"/store/getGrcode",success:function(t){1!=t&&$("#grcode").attr("src",t)},error:function(t,e){console.log("status:"+t.status),console.log("state:"+t.readyState),console.log("text:"+e)}})}),{doTinit:doTinit,getHost:getHost,exeError:exeError,formatDate:formatDate,ReConsole:ReConsole,isExitsVariable:isExitsVariable,isExitsFunction:isExitsFunction}}),require.config({paths:{core:"../lovejs/core"}}),define("login_index",function(){});